# Complete AI Agent Tutorial - Step by Step

## ğŸ¯ What We're Building
An AI agent that can search Google and answer questions using the latest information. Perfect for research, daily tasks, and productivity automation.

---

## ğŸ“‹ Prerequisites
- Python 3.10+ installed
- Google Cloud account (for Vertex AI)
- Terminal/command line access

---

## ğŸš€ STEP-BY-STEP IMPLEMENTATION

### STEP 1: Create Project Folder (5 seconds)

**What this does:** Creates organized folders for your code

**Commands:**
```bash
mkdir ai-agent-prod
cd ai-agent-prod
mkdir -p tools agents config
```

**Explanation:**
- `ai-agent-prod` = main project folder
- `tools/` = where Google Search tool lives
- `agents/` = where agent logic lives
- `config/` = configuration files

**Terminal output you'll see:**
```
(folders created silently)
```

---

### STEP 2: Create Virtual Environment (5 seconds)

**What this does:** Isolates your project dependencies from other Python projects

**Commands:**
```bash
python3 -m venv venv
source venv/bin/activate
```

**For Windows users:**
```bash
python -m venv venv
venv\Scripts\activate
```

**Explanation:**
- Creates isolated Python environment
- Prevents version conflicts with other projects
- You'll see `(venv)` in your terminal prompt

**Terminal output:**
```bash
(venv) user@computer:~/ai-agent-prod$
```

---

### STEP 3: Create requirements.txt (10 seconds)

**What this does:** Lists all Python packages needed

**Command:**
```bash
cat > requirements.txt << 'EOF'
google-adk>=0.1.0
google-genai>=2.0.0
mcp>=1.0.0
python-dotenv>=1.0.0
opentelemetry-api>=1.25.0
opentelemetry-sdk>=1.25.0
pydantic>=2.0.0
aiohttp>=3.8.0
httpx>=0.24.0
EOF
```

**Explanation of each package:**
- `google-adk` = Google Agent Development Kit (main framework)
- `google-genai` = Google's Gemini AI models
- `mcp` = Model Context Protocol (for tools)
- `python-dotenv` = Manages environment variables
- `opentelemetry-*` = Logging, tracing, metrics
- `pydantic` = Data validation
- `aiohttp` = Async HTTP requests
- `httpx` = Alternative HTTP client

**Terminal output:**
```
(file created silently)
```

---

### STEP 4: Install Dependencies (2-3 minutes)

**What this does:** Downloads and installs all required packages

**Command:**
```bash
pip install -r requirements.txt
```

**Explanation:**
- Downloads packages from PyPI (Python Package Index)
- Installs them in your virtual environment
- May take 2-3 minutes depending on internet speed

**Terminal output you'll see:**
```
Collecting google-adk>=0.1.0
  Downloading google_adk-0.1.0-py3-none-any.whl (123 kB)
Collecting google-genai>=2.0.0
  Downloading google_genai-2.0.0-py3-none-any.whl (456 kB)
...
Successfully installed google-adk-0.1.0 google-genai-2.0.0 ...
```

---

### STEP 5: Create .env Configuration File (30 seconds)

**What this does:** Stores sensitive API keys and configuration

**Command:**
```bash
cat > .env << 'EOF'
# Google Cloud Configuration
GOOGLE_GENAI_USE_VERTEXAI=true
GOOGLE_CLOUD_PROJECT=your-gcp-project-id
GOOGLE_CLOUD_LOCATION=us-central1

# API Keys
GOOGLE_API_KEY=your-google-api-key
GOOGLE_SEARCH_ENGINE_ID=your-search-engine-id

# MCP Configuration
MCP_SERVER_HOST=localhost
MCP_SERVER_PORT=8000

# Observability
ENABLE_TRACING=true
LOG_LEVEL=INFO
EOF
```

**âš ï¸ IMPORTANT: Replace these values:**
- `your-gcp-project-id` â†’ Your Google Cloud project ID
- `your-google-api-key` â†’ Your Google API key
- `your-search-engine-id` â†’ Your Google Custom Search Engine ID

**How to get these:**
1. **GCP Project ID**: Go to Google Cloud Console â†’ Select project â†’ Copy project ID
2. **Google API Key**: Google Cloud Console â†’ APIs & Services â†’ Credentials â†’ Create API Key
3. **Search Engine ID**: https://programmablesearchengine.google.com/ â†’ Create search engine â†’ Copy ID

**Terminal output:**
```
(file created silently)
```

---

### STEP 6: Authenticate with Google Cloud (1 minute)

**What this does:** Logs you into Google Cloud so the agent can use Vertex AI

**Command:**
```bash
gcloud auth application-default login
```

**Explanation:**
- Opens browser for Google login
- Saves credentials locally
- Agent will use these credentials automatically

**Terminal output:**
```
Your browser has been opened to visit:
https://accounts.google.com/o/oauth2/auth...

Credentials saved to file: [/home/user/.config/gcloud/application_default_credentials.json]
```

---

### STEP 7: Create Google Search Tool (2 minutes)

**What this does:** Creates the tool that searches Google

**Command:**
```bash
cat > tools/google_search_tool.py << 'EOF'
"""
Google Search MCP Tool
Enables the agent to search the web for current information
"""
import asyncio
import os
from typing import List, Dict
import httpx
from mcp.server import Server
from mcp.types import Tool, TextContent

class GoogleSearchMCP:
    """MCP Server for Google Custom Search"""
    
    def __init__(self, api_key: str, search_engine_id: str):
        self.api_key = api_key
        self.search_engine_id = search_engine_id
        self.server = Server("google-search")
        self.search_count = 0
        
        # Register tool
        @self.server.list_tools()
        async def list_tools() -> List[Tool]:
            return [
                Tool(
                    name="google_search",
                    description="Search Google for current information. Use this when you need up-to-date facts, news, or web content.",
                    inputSchema={
                        "type": "object",
                        "properties": {
                            "query": {
                                "type": "string",
                                "description": "Search query"
                            },
                            "num_results": {
                                "type": "integer",
                                "description": "Number of results (default: 5)",
                                "default": 5
                            }
                        },
                        "required": ["query"]
                    }
                )
            ]
        
        # Handle search requests
        @self.server.call_tool()
        async def call_tool(name: str, arguments: dict) -> List[TextContent]:
            if name == "google_search":
                query = arguments.get("query", "")
                num_results = arguments.get("num_results", 5)
                
                print(f"[SEARCH] Query: {query}")
                results = await self.search(query, num_results)
                
                # Format results
                formatted = self._format_results(results)
                return [TextContent(type="text", text=formatted)]
            
            return [TextContent(type="text", text="Unknown tool")]
    
    async def search(self, query: str, num_results: int = 5) -> List[Dict]:
        """Execute Google Custom Search API request"""
        url = "https://www.googleapis.com/customsearch/v1"
        params = {
            "key": self.api_key,
            "cx": self.search_engine_id,
            "q": query,
            "num": num_results
        }
        
        self.search_count += 1
        
        async with httpx.AsyncClient() as client:
            response = await client.get(url, params=params)
            data = response.json()
            
            return data.get("items", [])
    
    def _format_results(self, results: List[Dict]) -> str:
        """Format search results for LLM"""
        if not results:
            return "No results found."
        
        formatted = []
        for i, result in enumerate(results, 1):
            title = result.get("title", "No title")
            snippet = result.get("snippet", "No description")
            link = result.get("link", "")
            
            formatted.append(f"{i}. {title}\n{snippet}\nSource: {link}")
        
        return "\n\n".join(formatted)
    
    async def run(self):
        """Start MCP server"""
        print(f"[MCP] Google Search server starting on port 8000...")
        await self.server.run()

# Standalone execution
if __name__ == "__main__":
    api_key = os.getenv("GOOGLE_API_KEY")
    search_id = os.getenv("GOOGLE_SEARCH_ENGINE_ID")
    
    if not api_key or not search_id:
        print("âŒ Missing GOOGLE_API_KEY or GOOGLE_SEARCH_ENGINE_ID in .env")
        exit(1)
    
    tool = GoogleSearchMCP(api_key, search_id)
    asyncio.run(tool.run())
EOF
```

**Explanation:**
- **Lines 1-11**: Imports and class definition
- **Lines 13-22**: Initialize MCP server and register tool
- **Lines 24-45**: Define tool schema (what the agent sees)
- **Lines 47-63**: Handle search requests from agent
- **Lines 65-80**: Execute actual Google API call
- **Lines 82-95**: Format results for agent to read
- **Lines 97-109**: Standalone server mode

**Key concepts:**
- **MCP (Model Context Protocol)**: Standard way for agents to use tools
- **Tool registration**: Tells agent "I can search Google"
- **Async/await**: Enables non-blocking operations

**Terminal output:**
```
(file created silently)
```

---

### STEP 8: Create Agent Orchestrator (3 minutes)

**What this does:** Creates the main agent brain that uses Google Search

**Command:**
```bash
cat > agents/orchestrator.py << 'EOF'
"""
Agent Orchestrator
Manages agent lifecycle, sessions, and tool coordination
"""
import asyncio
import os
from typing import Dict, List
from google import genai
from google.genai.types import Tool, GenerateContentConfig, GoogleSearch
import time

class AgentSystem:
    """
    Multi-agent orchestration system with:
    - LLM-powered reasoning (Gemini)
    - Google Search integration
    - Session & memory management
    - Observability (metrics, logging)
    """
    
    def __init__(self):
        self.client = None
        self.sessions = {}  # Session storage
        self.metrics = {
            "queries_processed": 0,
            "searches_executed": 0,
            "total_tokens": 0,
            "total_time": 0,
            "errors": 0
        }
        
    async def initialize(self):
        """Initialize agent system with Google Vertex AI"""
        print("[INIT] Connecting to Google Vertex AI...")
        
        project = os.getenv("GOOGLE_CLOUD_PROJECT")
        location = os.getenv("GOOGLE_CLOUD_LOCATION", "us-central1")
        
        if not project:
            raise ValueError("GOOGLE_CLOUD_PROJECT not set in .env")
        
        # Initialize Vertex AI client
        self.client = genai.Client(
            vertexai=True,
            project=project,
            location=location
        )
        
        print(f"[INIT] Connected to project: {project}")
        print("[INIT] Agent system initialized âœ“")
    
    async def process_query(self, user_id: str, session_id: str, query: str) -> str:
        """
        Process user query with agent
        
        Flow:
        1. Retrieve session history
        2. Decide if search needed
        3. Execute search if needed
        4. Generate response with LLM
        5. Update session & metrics
        """
        start_time = time.time()
        
        # Get or create session
        session = self._get_session(user_id, session_id)
        
        print(f"\n[AGENT] Processing query for session {session_id}")
        print(f"[AGENT] Query: {query}")
        
        try:
            # Configure agent with Google Search tool
            config = GenerateContentConfig(
                temperature=0.7,
                top_p=0.95,
                max_output_tokens=2048,
                tools=[Tool(google_search=GoogleSearch())]
            )
            
            # Add query to session history
            session["history"].append({
                "role": "user",
                "parts": [{"text": query}]
            })
            
            # Generate response
            print("[AGENT] Generating response...")
            response = await self.client.aio.models.generate_content(
                model="gemini-2.0-flash-exp",
                contents=session["history"],
                config=config
            )
            
            # Extract response text
            response_text = response.text
            
            # Check if search was used
            if hasattr(response, 'candidates') and response.candidates:
                candidate = response.candidates[0]
                if hasattr(candidate, 'grounding_metadata'):
                    print("[AGENT] âœ“ Google Search was used")
                    self.metrics["searches_executed"] += 1
            
            # Add response to history
            session["history"].append({
                "role": "model",
                "parts": [{"text": response_text}]
            })
            
            # Update metrics
            elapsed = time.time() - start_time
            self.metrics["queries_processed"] += 1
            self.metrics["total_time"] += elapsed
            
            # Token usage (if available)
            if hasattr(response, 'usage_metadata'):
                tokens = response.usage_metadata.total_token_count
                self.metrics["total_tokens"] += tokens
                print(f"[METRICS] Tokens used: {tokens}")
            
            print(f"[METRICS] Response time: {elapsed:.2f}s")
            
            return response_text
            
        except Exception as e:
            self.metrics["errors"] += 1
            print(f"[ERROR] {str(e)}")
            return f"Error processing query: {str(e)}"
    
    def _get_session(self, user_id: str, session_id: str) -> Dict:
        """Get or create session"""
        key = f"{user_id}:{session_id}"
        
        if key not in self.sessions:
            print(f"[SESSION] Creating new session: {session_id}")
            self.sessions[key] = {
                "user_id": user_id,
                "session_id": session_id,
                "history": [],
                "metadata": {},
                "created_at": time.time()
            }
        
        return self.sessions[key]
    
    async def terminate(self, user_id: str, session_id: str):
        """Graceful termination - save session data"""
        print("\n[SHUTDOWN] Saving session data...")
        
        key = f"{user_id}:{session_id}"
        session = self.sessions.get(key)
        
        if session:
            # In production, save to database
            print(f"[SHUTDOWN] Session {session_id} has {len(session['history'])} messages")
        
        # Print final metrics
        print("\n[METRICS] Final Statistics:")
        print(f"  Queries processed: {self.metrics['queries_processed']}")
        print(f"  Searches executed: {self.metrics['searches_executed']}")
        print(f"  Total tokens: {self.metrics['total_tokens']}")
        print(f"  Avg response time: {self.metrics['total_time'] / max(self.metrics['queries_processed'], 1):.2f}s")
        print(f"  Errors: {self.metrics['errors']}")
        
        print("[SHUTDOWN] Cleanup complete âœ“")

# Global instance
agent_system = AgentSystem()
EOF
```

**Explanation:**

**Lines 1-29**: Setup and initialization
- Imports Google's Gemini AI
- Creates metrics tracking
- Initializes session storage

**Lines 31-48**: `initialize()` function
- Connects to Google Vertex AI
- Sets up authentication
- Validates configuration

**Lines 50-128**: `process_query()` function - **THE MAIN LOGIC**
1. **Line 60**: Get session (conversation history)
2. **Lines 68-73**: Configure agent with Google Search tool
3. **Lines 75-79**: Add user query to history
4. **Lines 81-87**: Call Gemini AI to generate response
5. **Lines 94-99**: Check if Google Search was used
6. **Lines 101-105**: Save response to history
7. **Lines 107-121**: Track metrics

**Lines 130-147**: Session management
- Creates new sessions as needed
- Stores conversation history

**Lines 149-167**: Graceful shutdown
- Saves all data
- Prints final statistics

**Terminal output:**
```
(file created silently)
```

---

### STEP 9: Create Main Application (2 minutes)

**What this does:** Creates the main program that ties everything together

**Command:**
```bash
cat > main.py << 'EOF'
"""
AI Agent Main Application
Entry point with terminal interface
"""
import asyncio
import signal
import sys
from agents.orchestrator import agent_system
import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# Graceful shutdown handler
shutdown_event = asyncio.Event()

def signal_handler(sig, frame):
    """Handle Ctrl+C for clean termination"""
    print("\n\nğŸ›‘ Shutdown signal received...")
    shutdown_event.set()

async def main():
    """Main application loop"""
    
    # Register signal handlers
    signal.signal(signal.SIGINT, signal_handler)
    signal.signal(signal.SIGTERM, signal_handler)
    
    print("=" * 60)
    print("ğŸ¤– AI AGENT WITH GOOGLE SEARCH")
    print("=" * 60)
    print("\nğŸš€ Starting system...\n")
    
    try:
        # Initialize agent system
        await agent_system.initialize()
        
        print("\nâœ… System ready!")
        print("=" * 60)
        print("ğŸ’¡ The agent can search Google for current information")
        print("ğŸ’¡ Type your questions below")
        print("ğŸ’¡ Commands: 'exit', 'quit', 'metrics', Ctrl+C to stop")
        print("=" * 60)
        
        user_id = "user_001"
        session_id = "session_main"
        
        # Main interaction loop
        while not shutdown_event.is_set():
            try:
                # Get user input
                query = input("\nğŸ’¬ You: ").strip()
                
                if not query:
                    continue
                
                # Handle special commands
                if query.lower() in ["exit", "quit", "stop"]:
                    print("\nğŸ‘‹ Goodbye!")
                    break
                
                if query.lower() == "metrics":
                    print("\nğŸ“Š Current Metrics:")
                    print(f"  Queries: {agent_system.metrics['queries_processed']}")
                    print(f"  Searches: {agent_system.metrics['searches_executed']}")
                    print(f"  Tokens: {agent_system.metrics['total_tokens']}")
                    continue
                
                # Process query with agent
                print("\nğŸ¤– Agent: ", end="", flush=True)
                response = await agent_system.process_query(user_id, session_id, query)
                print(response)
            
            except EOFError:
                # Handle Ctrl+D
                break
            except Exception as e:
                print(f"\nâŒ Error: {e}")
                continue
    
    except Exception as e:
        print(f"\nâŒ Fatal error: {e}")
        return 1
    
    finally:
        # Termination process
        print("\n\nğŸ”„ Shutting down gracefully...")
        await agent_system.terminate(user_id, session_id)
        print("âœ… Shutdown complete\n")
        return 0

if __name__ == "__main__":
    try:
        exit_code = asyncio.run(main())
        sys.exit(exit_code)
    except KeyboardInterrupt:
        print("\n\nğŸ‘‹ Interrupted. Goodbye!")
        sys.exit(0)
EOF
```

**Explanation:**

**Lines 1-14**: Setup
- Import agent system
- Load environment variables from .env
- Set up async event handling

**Lines 16-21**: Shutdown handler
- Catches Ctrl+C gracefully
- Triggers cleanup process

**Lines 23-92**: Main function - **THE APPLICATION LOOP**
1. **Lines 26-28**: Register shutdown signals
2. **Lines 36**: Initialize agent (connects to Google)
3. **Lines 48-50**: Main interaction loop
4. **Lines 53**: Get user input from terminal
5. **Lines 59-62**: Handle exit commands
6. **Lines 64-69**: Handle 'metrics' command
7. **Lines 72-74**: Send query to agent & display response
8. **Lines 84-87**: Graceful shutdown with data saving

**Terminal output:**
```
(file created silently)
```

---



**Now you can type queries!**

---

## ğŸ’¡ EXAMPLE USAGE SESSION

### Example 1: Simple Question (No Search)

```
ğŸ’¬ You: What is Python?

ğŸ¤– Agent: [AGENT] Processing query for session session_main
[AGENT] Query: What is Python?
[AGENT] Generating response...
[METRICS] Response time: 1.34s

Python is a high-level, interpreted programming language known for 
its simplicity and readability. It's widely used for web development, 
data science, automation, and AI applications.
```

**Explanation:** Agent used its built-in knowledge, no search needed.

---

### Example 2: Current Information (Uses Search)

```
ğŸ’¬ You: What are the latest AI breakthroughs this week?

ğŸ¤– Agent: [AGENT] Processing query for session session_main
[AGENT] Query: What are the latest AI breakthroughs this week?
[AGENT] Generating response...
[AGENT] âœ“ Google Search was used
[METRICS] Tokens used: 1247
[METRICS] Response time: 3.89s

Based on recent search results, here are the latest AI breakthroughs:

1. **Google's Gemini 2.0**: Released a new multimodal AI model with 
   improved reasoning capabilities.

2. **OpenAI's GPT-5 Progress**: Rumors of significant advances in 
   training efficiency.

3. **AI Safety Research**: New papers on alignment and control 
   mechanisms published this week.

Sources: TechCrunch, VentureBeat, ArXiv
```

**Explanation:** Agent detected temporal keywords ("latest", "this week") and automatically searched Google.

---

### Example 3: Check Metrics

```
ğŸ’¬ You: metrics

ğŸ“Š Current Metrics:
  Queries: 2
  Searches: 1
  Tokens: 1723
```

---

### Example 4: Exit

```
ğŸ’¬ You: exit

ğŸ‘‹ Goodbye!

ğŸ”„ Shutting down gracefully...
[SHUTDOWN] Saving session data...
[SHUTDOWN] Session session_main has 4 messages

[METRICS] Final Statistics:
  Queries processed: 2
  Searches executed: 1
  Total tokens: 1723
  Avg response time: 2.62s
  Errors: 0
[SHUTDOWN] Cleanup complete âœ“
âœ… Shutdown complete
```

---

## ğŸ›‘ TERMINATION PROCESS - ALL METHODS

### Method 1: Normal Exit (Recommended)

**Command:** Type `exit` or `quit`

**What happens:**
1. Agent saves conversation history
2. Prints final metrics
3. Closes connections gracefully
4. Exits cleanly

**Duration:** 2-5 seconds

---

### Method 2: Keyboard Interrupt (Ctrl+C)

**Command:** Press `Ctrl+C`

**What happens:**
1. Signal handler catches interrupt
2. Triggers graceful shutdown
3. Saves data before exit
4. Prints statistics

**Duration:** 2-5 seconds

**Terminal output:**
```
^C
ğŸ›‘ Shutdown signal received...

ğŸ”„ Shutting down gracefully...
[SHUTDOWN] Saving session data...
âœ… Shutdown complete
```

---

### Method 3: Force Kill (Emergency Only)

**Find process ID:**
```bash
ps aux | grep python
```

**Kill process:**
```bash
kill -9 <process_id>
```

**âš ï¸ Warning:** This skips cleanup! Use only if agent is frozen.

**Duration:** Instant

---

## ğŸ“Š COMPLETE TERMINAL WORKFLOW DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Setup (30 seconds)                              â”‚
â”‚ mkdir, cd, create folders                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2-4: Environment & Dependencies (3 minutes)        â”‚
â”‚ venv, requirements.txt, pip install                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5-6: Configuration (2 minutes)                     â”‚
â”‚ .env file, gcloud auth                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7-9: Code Creation (7 minutes)                     â”‚
â”‚ google_search_tool.py, orchestrator.py, main.py         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 10: Run Agent                                      â”‚
â”‚ python main.py                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â—† USER INTERACTION LOOP â—†                               â”‚
â”‚                                                          â”‚
â”‚  1. You type query                                       â”‚
â”‚  2. Agent thinks (checks if search needed)               â”‚
â”‚  3. Agent searches Google (if needed)                    â”‚
â”‚  4. Agent generates response                             â”‚
â”‚  5. You see response + metrics                           â”‚
â”‚  6. Repeat...                                            â”‚
â”‚                                                          â”‚
â”‚  Type 'exit', 'quit', or Ctrl+C to stop                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TERMINATION (2-5 seconds)                                â”‚
â”‚ - Save session data                                      â”‚
â”‚ - Print final metrics                                    â”‚
â”‚ - Close connections                                      â”‚
â”‚ - Exit cleanly                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ KEY CONCEPTS EXPLAINED SIMPLY

### 1. **What is an Agent?**
An AI program that can:
- Think (use LLM like Gemini)
- Act (use tools like Google Search)
- Remember (save conversation history)
- Decide (choose when to search vs use knowledge)

### 2. **What is MCP (Model Context Protocol)?**
A standard way for agents to use tools. Think of it like USB ports - MCP is the standard, tools are USB devices.

### 3. **What is a Session?**
Your conversation with the agent. Like a chat thread that remembers previous messages.

### 4. **What is Async/Await?**
Lets the program do multiple things at once without freezing. Like multitasking.

### 5. **What is Vertex AI?**
Google's cloud platform for running AI models. Your agent uses Gemini hosted on Vertex AI.

---

## ğŸ› TROUBLESHOOTING

### Problem: "GOOGLE_CLOUD_PROJECT not set"
**Solution:** Edit .env file and add your project ID:
```bash
GOOGLE_CLOUD_PROJECT=your-actual-project-id
```

### Problem: "Authentication failed"
**Solution:** Run authentication again:
```bash
gcloud auth application-default login
```

### Problem: "Module not found"
**Solution:** Make sure venv is activated and dependencies installed:
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### Problem: "Search returns no results"
**Solution:** Check your Search Engine ID in .env is correct

### Problem: Agent freezes
**Solution:** Press Ctrl+C or use `kill -9` to force stop

---

## ğŸ¯ SUMMARY

**Total Setup Time:** ~15 minutes  
**Lines of Code:** ~400  
**External Services:** Google Cloud (Vertex AI + Custom Search)  
**Cost:** Free tier available, pay-per-use after  

**What You Built:**
âœ… AI agent powered by Gemini  
âœ… Google Search integration  
âœ… Session & memory management  
âœ… Metrics & observability  
âœ… Graceful shutdown  
âœ… Terminal interface  

**Next Steps:**
1. Try different queries
2. Add more tools (calendar, email, etc.)
3. Build web interface
4. Deploy to production

---

## ğŸ“š ALL COMMANDS IN ONE PLACE

```bash
# Complete setup (copy all at once)
mkdir ai-agent-prod && cd ai-agent-prod
mkdir -p tools agents config
python3 -m venv venv
source venv/bin/activate
pip install google-adk google-genai mcp python-dotenv opentelemetry-api opentelemetry-sdk pydantic aiohttp httpx
gcloud auth application-default login

# Create .env (edit after creating)
touch .env

# Run agent
python main.py

# Exit options
# Option 1: Type 'exit' or 'quit'
# Option 2: Press Ctrl+C
# Option 3: kill -9 <process_id> (emergency only)
```

---

